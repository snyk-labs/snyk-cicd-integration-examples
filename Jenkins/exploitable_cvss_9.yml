# This is an example of a filter to be used with snyk-filter in Jenkins example. 
# Please see the snyk-filter repo for more information and formatting guidelines: https://github.com/snyk-tech-services/snyk-filter
version: 2
customFilters:
  filter: ".vulnerabilities |= map(if (  select(.exploit != null and .exploit != \"Not Defined\" and .exploit != \"Unproven\" and .cvssScore>=9.0)) then . else empty end)"
  pass: ".vulnerabilities[] | select(.exploit != null and .exploit != \"Not Defined\" and .exploit != \"Unproven\" and .cvssScore>=9.0) | length"
  msg: "Exploitable Vulnerabilities with CVSS Score of 9 or higher found"
